# –õ–µ–Ω—Ç–æ—á–Ω–∞—è –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–∞—è —Å—Ö–µ–º–∞ - —É–º–Ω–æ–∂–µ–Ω–∏–µ –º–∞—Ç—Ä–∏—Ü—ã –Ω–∞ –≤–µ–∫—Ç–æ—Ä

- –°—Ç—É–¥–µ–Ω—Ç: –ö—Ä—É–≥–ª–æ–≤–∞ –ê–ª—ë–Ω–∞ –í–∏—Ç–∞–ª—å–µ–≤–Ω–∞, –≥—Ä—É–ø–ø–∞ 3823–ë1–§–ò2
- –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è: SEQ | MPI 
- –í–∞—Ä–∏–∞–Ω—Ç: 12

## 1. –í–≤–µ–¥–µ–Ω–∏–µ
–ó–∞–¥–∞—á–∞ —É–º–Ω–æ–∂–µ–Ω–∏—è –º–∞—Ç—Ä–∏—Ü—ã –Ω–∞ –≤–µ–∫—Ç–æ—Ä —è–≤–ª—è–µ—Ç—Å—è –æ–¥–Ω–æ–π –∏–∑ –±–∞–∑–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –ª–∏–Ω–µ–π–Ω–æ–π –∞–ª–≥–µ–±—Ä—ã –∏ —à–∏—Ä–æ–∫–æ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –≤ –Ω–∞—É—á–Ω—ã—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏—è—Ö, –º–∞—à–∏–Ω–Ω–æ–º –æ–±—É—á–µ–Ω–∏–∏, —á–∏—Å–ª–µ–Ω–Ω—ã—Ö –º–µ—Ç–æ–¥–∞—Ö –∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π. –î–ª—è –º–∞—Ç—Ä–∏—Ü –±–æ–ª—å—à–æ–π —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–π, —á—Ç–æ –¥–µ–ª–∞–µ—Ç –∞–∫—Ç—É–∞–ª—å–Ω—ã–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤.

–õ–µ–Ω—Ç–æ—á–Ω–∞—è –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–∞—è —Å—Ö–µ–º–∞ —Ä–∞—Å–ø–∞—Ä–∞–ª–ª–µ–ª–∏–≤–∞–Ω–∏—è –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç —Ä–∞–∑–±–∏–µ–Ω–∏–µ –∏—Å—Ö–æ–¥–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã –ø–æ —Å—Ç–æ–ª–±—Ü–∞–º –º–µ–∂–¥—É –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏. –ö–∞–∂–¥—ã–π –ø—Ä–æ—Ü–µ—Å—Å –≤—ã–ø–æ–ª–Ω—è–µ—Ç —É–º–Ω–æ–∂–µ–Ω–∏–µ —Å–≤–æ–µ–≥–æ –±–ª–æ–∫–∞ —Å—Ç–æ–ª–±—Ü–æ–≤ –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é —á–∞—Å—Ç—å –≤–µ–∫—Ç–æ—Ä–∞, —Ñ–æ—Ä–º–∏—Ä—É—è —á–∞—Å—Ç–∏—á–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç, –ø–æ—Å–ª–µ —á–µ–≥–æ –≥–ª–æ–±–∞–ª—å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ–ª—É—á–∞–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é –∫–æ–ª–ª–µ–∫—Ç–∏–≤–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π. –î–∞–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –ø–æ–∑–≤–æ–ª—è–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–∏—Ç—å –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É –∏ –ø—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–µ—Ö–∞–Ω–∏–∑–º–æ–≤ –æ–±–º–µ–Ω–∞ –¥–∞–Ω–Ω—ã–º–∏ –∏ —Ä–µ–¥—É–∫—Ü–∏–∏ –≤ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö.

–í —Ä–∞–º–∫–∞—Ö –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è –∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏–∏ —É–º–Ω–æ–∂–µ–Ω–∏—è –º–∞—Ç—Ä–∏—Ü—ã –Ω–∞ –≤–µ–∫—Ç–æ—Ä —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –ª–µ–Ω—Ç–æ—á–Ω–æ–π –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–π —Å—Ö–µ–º—ã, –∞ —Ç–∞–∫–∂–µ –ø—Ä–æ–≤–µ–¥–µ–Ω–æ –∏—Ö —Å—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω–æ–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ —Å —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

## 2. –ü–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–¥–∞—á–∏
**–§–æ—Ä–º–∞–ª—å–Ω–∞—è –ø–æ—Å—Ç–∞–Ω–æ–≤–∫–∞:**  –î–ª—è –∑–∞–¥–∞–Ω–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã `ùê¥` —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ `ùëÄ√óùëÅ`, —Å–æ—Å—Ç–æ—è—â–µ–π –∏–∑ –≤–µ—â–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —á–∏—Å–µ–ª (std::vector<double>), –∏ –≤–µ–∫—Ç–æ—Ä–∞ `ùëè` –¥–ª–∏–Ω—ã `ùëÅ` (std::vector<double>),—Ç—Ä–µ–±—É–µ—Ç—Å—è –≤—ã—á–∏—Å–ª–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∏—Ä—É—é—â–∏–π –≤–µ–∫—Ç–æ—Ä: `y = A ‚ãÖ b`.

**–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:** –í–µ–∫—Ç–æ—Ä `V` (std::vector<float>) –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–π –¥–ª–∏–Ω—ã.
- `M` ‚Äî —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫ –º–∞—Ç—Ä–∏—Ü—ã
- `N` ‚Äî —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç–æ–ª–±—Ü–æ–≤ –º–∞—Ç—Ä–∏—Ü—ã
- `A` ‚Äî –º–∞—Ç—Ä–∏—Ü–∞ (std::vector<double>) —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ `M √ó N`, —Ö—Ä–∞–Ω—è—â–∞—è—Å—è –≤ –ø–æ—Å—Ç—Ä–æ—á–Ω–æ–º –≤–∏–¥–µ
- `b` ‚Äî –≤–µ–∫—Ç–æ—Ä (std::vector<double>) –¥–ª–∏–Ω—ã `N`

**–í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:** `y` ‚Äî –≤–µ–∫—Ç–æ—Ä (std::vector<double>) –¥–ª–∏–Ω—ã `M`, —è–≤–ª—è—é—â–∏–π—Å—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º —É–º–Ω–æ–∂–µ–Ω–∏—è –º–∞—Ç—Ä–∏—Ü—ã –Ω–∞ –≤–µ–∫—Ç–æ—Ä `b`

**–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:**
- `M ‚â• 0`, `N ‚â• 0`, –∞–ª–≥–æ—Ä–∏—Ç–º –¥–æ–ª–∂–µ–Ω –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å –ø—Ä–∏ –Ω—É–ª–µ–≤—ã—Ö —Ä–∞–∑–º–µ—Ä–∞—Ö
- –†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –º–∞—Ç—Ä–∏—Ü—ã –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∞ —Å –¥–ª–∏–Ω–æ–π –≤–µ–∫—Ç–æ—Ä–∞ (N)
- –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è MPI-–≤–µ—Ä—Å–∏—è –¥–æ–ª–∂–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –∏ —Ä–µ–∞–ª–∏–∑–æ–≤—ã–≤–∞—Ç—å –ª–µ–Ω—Ç–æ—á–Ω—É—é –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—É—é —Å—Ö–µ–º—É —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å—Ç–æ–ª–±—Ü–æ–≤ –º–∞—Ç—Ä–∏—Ü—ã –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤–µ–∫—Ç–æ—Ä–∞ `b`

## 3. –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è(Baseline)
–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è –∞–ª–≥–æ—Ä–∏—Ç–º–∞ —Ä–µ–∞–ª–∏–∑—É–µ—Ç –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–µ —É–º–Ω–æ–∂–µ–Ω–∏–µ –º–∞—Ç—Ä–∏—Ü—ã –Ω–∞ –≤–µ–∫—Ç–æ—Ä –±–µ–∑ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º–∞. –ú–∞—Ç—Ä–∏—Ü–∞ `ùê¥` —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ –ø–æ—Å—Ç—Ä–æ—á–Ω–æ–º –≤–∏–¥–µ, –∏ –¥–ª—è –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–∏ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è —Å–∫–∞–ª—è—Ä–Ω–æ–µ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ —Å –≤–µ–∫—Ç–æ—Ä–æ–º 
`ùëè`.
```cpp
for (int i = 0; i < rows; ++i) {
  double sum = 0.0;
  for (int j = 0; j < cols; ++j) {
    sum += matrix[(i * cols) + j] * vec_b[j];
  }
  res_y[i] = sum;
}
```
- –í—Ä–µ–º–µ–Ω–Ω–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å: `O(M‚ãÖN)`, –≥–¥–µ `ùëÄ` ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫ –º–∞—Ç—Ä–∏—Ü—ã, `ùëÅ` ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç–æ–ª–±—Ü–æ–≤.
- –ü–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏: `ùëÇ(1)` –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –ø–∞–º—è—Ç–∏ (–Ω–µ —Å—á–∏—Ç–∞—è –≤—Ö–æ–¥–Ω—ã—Ö –∏ –≤—ã—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö).

## 4. –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è
### 4.1. –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
–í –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–π –≤–µ—Ä—Å–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–∞—è –ª–µ–Ω—Ç–æ—á–Ω–∞—è —Å—Ö–µ–º–∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö. –ú–∞—Ç—Ä–∏—Ü–∞ 

$A \in \mathbb{R}^{rows \times cols}$

—Ä–∞–∑–±–∏–≤–∞–µ—Ç—Å—è –ø–æ —Å—Ç–æ–ª–±—Ü–∞–º –Ω–∞ size –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã—Ö –ª–µ–Ω—Ç:
- `base = cols / size`
- `rem = cols % size`
- –ø—Ä–æ—Ü–µ—Å—Å i –ø–æ–ª—É—á–∞–µ—Ç `local_cols = base + (i < rem ? 1 : 0)` —Å—Ç–æ–ª–±—Ü–æ–≤ –º–∞—Ç—Ä–∏—Ü—ã
- –∫–∞–∂–¥–æ–º—É –ø—Ä–æ—Ü–µ—Å—Å—É –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π —Ñ—Ä–∞–≥–º–µ–Ω—Ç –≤–µ–∫—Ç–æ—Ä–∞ `ùëè` –¥–ª–∏–Ω—ã `local_cols`
- –∫–∞–∂–¥–∞—è –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–∞—è –ª–µ–Ω—Ç–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ `rows` —Å—Ç—Ä–æ–∫, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã—á–∏—Å–ª—è—Ç—å —á–∞—Å—Ç–∏—á–Ω—ã–π –≤–∫–ª–∞–¥ –≤ —Ä–µ–∑—É–ª—å—Ç–∏—Ä—É—é—â–∏–π –≤–µ–∫—Ç–æ—Ä
–î–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö –º–∞—Ç—Ä–∏—Ü–∞ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ —Ç—Ä–∞–Ω—Å–ø–æ–Ω–∏—Ä—É–µ—Ç—Å—è –Ω–∞ –∫–æ—Ä–Ω–µ–≤–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ, –ø–æ—Å–ª–µ —á–µ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –ø–æ –ø—Ä–æ—Ü–µ—Å—Å–∞–º –∫–∞–∫ –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã–µ –±–ª–æ–∫–∏ –ø–∞–º—è—Ç–∏.
 
### 4.2. –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
1. **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∑–∞–¥–∞—á–∏**  
   –ü—Ä–æ—Ü–µ—Å—Å 0 –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ä–∞–∑–º–µ—Ä—ã –º–∞—Ç—Ä–∏—Ü—ã rows –∏ cols –∏ —Ä–∞—Å—Å—ã–ª–∞–µ—Ç –∏—Ö –≤—Å–µ–º –ø—Ä–æ—Ü–µ—Å—Å–∞–º —Å –ø–æ–º–æ—â—å—é `MPI_Bcast`
2. **–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤–µ–∫—Ç–æ—Ä–∞ `ùëè`**  
   –§–æ—Ä–º–∏—Ä—É—é—Ç—Å—è –º–∞—Å—Å–∏–≤—ã sendcounts –∏ displs, –æ–ø—Ä–µ–¥–µ–ª—è—é—â–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤–µ–∫—Ç–æ—Ä–∞ ùëè, –ø–µ—Ä–µ–¥–∞–≤–∞–µ–º—ã—Ö –∫–∞–∂–¥–æ–º—É –ø—Ä–æ—Ü–µ—Å—Å—É. –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º `MPI_Scatterv`.
3. **–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –º–∞—Ç—Ä–∏—Ü—ã**  
   –ù–∞ –∫–æ—Ä–Ω–µ–≤–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ –º–∞—Ç—Ä–∏—Ü–∞ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ —Ç—Ä–∞–Ω—Å–ø–æ–Ω–∏—Ä—É–µ—Ç—Å—è. –ó–∞—Ç–µ–º –∫–∞–∂–¥–∞—è –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–∞—è –ª–µ–Ω—Ç–∞ (–Ω–∞–±–æ—Ä —Å—Ç–æ–ª–±—Ü–æ–≤) –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–º—É –ø—Ä–æ—Ü–µ—Å—Å—É –ø–æ—Å—Ä–µ–¥—Å—Ç–≤–æ–º `MPI_Scatterv`.
4. **–†–µ–¥—É–∫—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤**  
   –ö–∞–∂–¥—ã–π –ø—Ä–æ—Ü–µ—Å—Å –≤—ã—á–∏—Å–ª—è–µ—Ç –ª–æ–∫–∞–ª—å–Ω—ã–π –≤–∫–ª–∞–¥ –≤ —Ä–µ–∑—É–ª—å—Ç–∏—Ä—É—é—â–∏–π –≤–µ–∫—Ç–æ—Ä:
  
   $y_i^{(local)} = \sum_{j \in local_cols} A_{ij} \cdot b_j$

   –†–µ–∑—É–ª—å—Ç–∞—Ç–æ–º —è–≤–ª—è–µ—Ç—Å—è —á–∞—Å—Ç–∏—á–Ω—ã–π –≤–µ–∫—Ç–æ—Ä –¥–ª–∏–Ω—ã rows.
5. **–†–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞**  
   –ß–∞—Å—Ç–∏—á–Ω—ã–µ –≤–µ–∫—Ç–æ—Ä—ã —Å—É–º–º–∏—Ä—É—é—Ç—Å—è –Ω–∞ –∫–æ—Ä–Ω–µ–≤–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º `MPI_Reduce` –∏ –æ–ø–µ—Ä–∞—Ü–∏–∏ `MPI_SUM`, —Ñ–æ—Ä–º–∏—Ä—É—è –∏—Ç–æ–≥–æ–≤—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç `ùë¶=ùê¥‚ãÖùëè`.

### 4.3. –ü—Å–µ–≤–¥–æ–∫–æ–¥ –∞–ª–≥–æ—Ä–∏—Ç–º–∞
```pseudocode
MPI_Init()
–ü–æ–ª—É—á–∏—Ç—å rank –∏ size

–ï—Å–ª–∏ rank == 0:
    rows, cols ‚Üê —Ä–∞–∑–º–µ—Ä—ã –º–∞—Ç—Ä–∏—Ü—ã
MPI_Bcast(rows)
MPI_Bcast(cols)

–í—ã—á–∏—Å–ª–∏—Ç—å sendcounts –∏ displs –¥–ª—è —Å—Ç–æ–ª–±—Ü–æ–≤

MPI_Scatterv(b ‚Üí local_b)

–ï—Å–ª–∏ rank == 0:
    —Ç—Ä–∞–Ω—Å–ø–æ–Ω–∏—Ä–æ–≤–∞—Ç—å –º–∞—Ç—Ä–∏—Ü—É A ‚Üí A_T

MPI_Scatterv(A_T ‚Üí local_matrix)

local_res[0..rows-1] = 0
–î–ª—è –∫–∞–∂–¥–æ–≥–æ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Å—Ç–æ–ª–±—Ü–∞ j:
    –î–ª—è –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–∏ i:
        local_res[i] += local_matrix[j][i] * local_b[j]

MPI_Reduce(local_res ‚Üí global_res, SUM)

–ï—Å–ª–∏ rank == 0:
    —Ä–µ–∑—É–ª—å—Ç–∞—Ç = global_res

MPI_Finalize()
```
## 5. –î–µ—Ç–∞–ª–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### 5.1. –§–∞–π–ª–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
kruglova_a_vertical_ribbon_matvec/  
‚îú‚îÄ‚îÄ common/include/common.hpp  
‚îú‚îÄ‚îÄ seq/include/ops_seq.hpp  
‚îú‚îÄ‚îÄ seq/src/ops_seq.cpp  
‚îú‚îÄ‚îÄ mpi/include/ops_mpi.hpp  
‚îú‚îÄ‚îÄ mpi/src/ops_mpi.cpp  
‚îú‚îÄ‚îÄ tests/functional/main.cpp  
‚îú‚îÄ‚îÄ tests/performance/main.cpp  
‚îî‚îÄ‚îÄ data/  

### 5.2. –ö–ª—é—á–µ–≤—ã–µ –∫–ª–∞—Å—Å—ã –∏ —Ñ—É–Ω–∫—Ü–∏–∏
- **InType** = `std::tuple<int, int, std::vector<double>, std::vector<double>>` ‚Äî –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ: —Ä–∞–∑–º–µ—Ä—ã –º–∞—Ç—Ä–∏—Ü—ã (rows, cols), –º–∞—Ç—Ä–∏—Ü–∞ 
`ùê¥` –≤ –ø–æ—Å—Ç—Ä–æ—á–Ω–æ–º –≤–∏–¥–µ –∏ –≤–µ–∫—Ç–æ—Ä `ùëè`
- **OutType** = std::vector<double> ‚Äî —Ä–µ–∑—É–ª—å—Ç–∏—Ä—É—é—â–∏–π –≤–µ–∫—Ç–æ—Ä `ùë¶=ùê¥ ‚ãÖ ùëè` –¥–ª–∏–Ω—ã rows
- **`RunImpl()`** ‚Äî —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–≥–æ —É–º–Ω–æ–∂–µ–Ω–∏—è –º–∞—Ç—Ä–∏—Ü—ã –Ω–∞ –≤–µ–∫—Ç–æ—Ä –ø–æ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–π –ª–µ–Ω—Ç–æ—á–Ω–æ–π —Å—Ö–µ–º–µ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º MPI
- **`ValidationImpl()`** ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏ —Ä–∞–∑–º–µ—Ä–æ–≤
- **`PreProcessingImpl()`** ‚Äî —Ä–∞—Å—Å—ã–ª–∫–∞ —Ä–∞–∑–º–µ—Ä–æ–≤ –∑–∞–¥–∞—á–∏ –∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤—ã—Ö–æ–¥–Ω–æ–≥–æ –≤–µ–∫—Ç–æ—Ä–∞
- **`PostProcessingImpl()`** ‚Äî –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏–π (–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è)
- **–í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:**
    - **`ComputeSendCountsAndDispls()`** ‚Äî —Ä–∞—Å—á—ë—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
    - **`TransposeMatrix()`** ‚Äî —Ç—Ä–∞–Ω—Å–ø–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –º–∞—Ç—Ä–∏—Ü—ã –Ω–∞ –∫–æ—Ä–Ω–µ–≤–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ
    - **`LocalMatVecMul()`** ‚Äî –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –≤–∫–ª–∞–¥–∞ –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç
- **–¢–µ—Å—Ç–æ–≤—ã–µ –∫–ª–∞—Å—Å—ã:**
    - **`KruglovaAVerticalRibbMatSEQ`** ‚Äî –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è
    - **`KruglovaAVerticalRibbMatMPI`** ‚Äî –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è MPI –≤–µ—Ä—Å–∏—è

### 5.3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏

**–í –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–π –≤–µ—Ä—Å–∏–∏ (SEQ):** –≤ –ø–∞–º—è—Ç–∏ —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤—Å—è –º–∞—Ç—Ä–∏—Ü–∞ `ùê¥`, –≤—Ö–æ–¥–Ω–æ–π –≤–µ–∫—Ç–æ—Ä `ùëè` –∏ —Ä–µ–∑—É–ª—å—Ç–∏—Ä—É—é—â–∏–π –≤–µ–∫—Ç–æ—Ä `ùë¶`.
**–í –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–π –≤–µ—Ä—Å–∏–∏ (MPI):**
- –ø—Ä–æ—Ü–µ—Å—Å 0 —Ö—Ä–∞–Ω–∏—Ç: –ø–æ–ª–Ω—É—é –º–∞—Ç—Ä–∏—Ü—É `ùê¥`, –≤—Ö–æ–¥–Ω–æ–π –≤–µ–∫—Ç–æ—Ä `ùëè`, —Ç—Ä–∞–Ω—Å–ø–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω—É—é –º–∞—Ç—Ä–∏—Ü—É, —Å–ª—É–∂–µ–±–Ω—ã–µ –º–∞—Å—Å–∏–≤—ã `sendcounts` –∏ `displs`
- –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã —Ö—Ä–∞–Ω—è—Ç: —Ç–æ–ª—å–∫–æ —Å–≤–æ—é –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—É—é –ª–µ–Ω—Ç—É –º–∞—Ç—Ä–∏—Ü—ã, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π —Ñ—Ä–∞–≥–º–µ–Ω—Ç –≤–µ–∫—Ç–æ—Ä–∞ `ùëè`, –ª–æ–∫–∞–ª—å–Ω—ã–π —á–∞—Å—Ç–∏—á–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∏—Ä—É—é—â–∏–π –≤–µ–∫—Ç–æ—Ä –¥–ª–∏–Ω—ã `rows`.
–¢–∞–∫–∞—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è –ø–∞–º—è—Ç–∏ —Å–Ω–∏–∂–∞–µ—Ç –æ–±—ä—ë–º —Ö—Ä–∞–Ω–∏–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –∫–∞–∂–¥–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ –∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –ø—Ä–∏ —É–≤–µ–ª–∏—á–µ–Ω–∏–∏ —á–∏—Å–ª–∞ MPI-–ø—Ä–æ—Ü–µ—Å—Å–æ–≤.

## 6. –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
–≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –ø—Ä–æ–≤–æ–¥–∏–ª–∏—Å—å –Ω–∞ –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ —Å –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–æ–º **AMD Ryzen 5 5500U**, –æ—Å–Ω–∞—â—ë–Ω–Ω—ã–º **6** –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã–º–∏ —è–¥—Ä–∞–º–∏ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–π –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç–∏. –ê–ø–ø–∞—Ä–∞—Ç–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤–∫–ª—é—á–∞–µ—Ç **16 –ì–ë** –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç–∏ **DDR4** –∏ —Ç–≤–µ—Ä–¥–æ—Ç–µ–ª—å–Ω—ã–π –Ω–∞–∫–æ–ø–∏—Ç–µ–ª—å –æ–±—ä—ë–º–æ–º **512 –ì–ë**, —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä—É—é—â–∏–π –ø–æ–¥ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã **Windows 10**.

–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –∏ –∫–æ–º–ø–∏–ª—è—Ü–∏—è –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –∫–æ–¥–∞ –≤—ã–ø–æ–ª–Ω—è–ª–∏—Å—å –≤ —Å—Ä–µ–¥–µ **Microsoft Visual Studio 2019** —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä–∞ C++. –î–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π –ø—Ä–∏–º–µ–Ω—è–ª–∞—Å—å –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ **Microsoft MPI** –≤–µ—Ä—Å–∏–∏ **10.0.12498.5**, –∞ —Å–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞ –æ—Å—É—â–µ—Å—Ç–≤–ª—è–ª–∞—Å—å —Å –ø–æ–º–æ—â—å—é —Å–∏—Å—Ç–µ–º—ã **CMake –≤–µ—Ä—Å–∏–∏ 3.30.4** –≤ —Ä–µ–∂–∏–º–µ **Release**.

–í —Ö–æ–¥–µ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤ —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–ª–∞—Å—å –∑–∞–¥–∞—á–∞ —É–º–Ω–æ–∂–µ–Ω–∏—è –ø–ª–æ—Ç–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã –Ω–∞ –≤–µ–∫—Ç–æ—Ä —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–π –ª–µ–Ω—Ç–æ—á–Ω–æ–π —Å—Ö–µ–º—ã —Ä–∞—Å–ø–∞—Ä–∞–ª–ª–µ–ª–∏–≤–∞–Ω–∏—è. –†–∞–∑–º–µ—Ä –º–∞—Ç—Ä–∏—Ü—ã –±—ã–ª –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω –∏ –≤–æ –≤—Å–µ—Ö —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞—Ö —Å–æ—Å—Ç–∞–≤–ª—è–ª **5000 √ó 5000**. –ó–Ω–∞—á–µ–Ω–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –º–∞—Ç—Ä–∏—Ü—ã –∏ –≤–µ–∫—Ç–æ—Ä–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–ª–∏—Å—å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º–∏ –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞–º–∏, —á—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–ª–æ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤.

–î–ª—è –æ—Ü–µ–Ω–∫–∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –ø—Ä–æ–≤–æ–¥–∏–ª–∏—Å—å –∑–∞–ø—É—Å–∫–∏ –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è—Ö —Å 1, 2, 4 –∏ 6 MPI-–ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏. –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –≤—ã—á–∏—Å–ª–µ–Ω–∏–π –ø—Ä–æ–≤–µ—Ä—è–ª–∞—Å—å —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–π –∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π, –∞ –∏–∑–º–µ—Ä–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –≤—ã–ø–æ–ª–Ω—è–ª–æ—Å—å –≤ —Ä–µ–∂–∏–º–µ –º–Ω–æ–≥–æ–∫—Ä–∞—Ç–Ω—ã—Ö –∑–∞–ø—É—Å–∫–æ–≤ —Å —É—Å—Ä–µ–¥–Ω–µ–Ω–∏–µ–º –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.

## 7. –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

### 7.1 –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å
–ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞ Google Test.
–†–µ–∑—É–ª—å—Ç–∞—Ç—ã, –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ MPI-–≤–µ—Ä—Å–∏–µ–π –∞–ª–≥–æ—Ä–∏—Ç–º–∞ —É–º–Ω–æ–∂–µ–Ω–∏—è –º–∞—Ç—Ä–∏—Ü—ã –Ω–∞ –≤–µ–∫—Ç–æ—Ä (KruglovaAVerticalRibbMatMPI), —Å—Ä–∞–≤–Ω–∏–≤–∞–ª–∏—Å—å —Å —ç—Ç–∞–ª–æ–Ω–Ω–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–µ–π (KruglovaAVerticalRibbMatSEQ). –ü—Ä–æ–≤–µ—Ä–∫–∏ –≤—ã–ø–æ–ª–Ω—è–ª–∏—Å—å –¥–ª—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π —á–∏—Å–ª–∞ MPI-–ø—Ä–æ—Ü–µ—Å—Å–æ–≤. 

### 7.2 –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
–ò–∑–º–µ—Ä–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –ø—Ä–æ–≤–æ–¥–∏–ª–∏—Å—å –¥–ª—è –∑–∞–¥–∞—á–∏ —É–º–Ω–æ–∂–µ–Ω–∏—è –ø–ª–æ—Ç–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã —Ä–∞–∑–º–µ—Ä–æ–º 5000 √ó 5000. –í —Ç–∞–±–ª–∏—Ü–µ –ø—Ä–∏–≤–µ–¥–µ–Ω–æ —Å—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è, –ø–æ–ª—É—á–µ–Ω–Ω–æ–µ –ø–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º —Å–µ—Ä–∏–∏ –∑–∞–ø—É—Å–∫–æ–≤.

| Mode        | Count | Time, s | Speedup | Efficiency |
|-------------|-------|---------|---------|------------|
| seq         | 1     | 0.013   | 1.00    | N/A        |
| mpi         | 2     | 0.038   | 0.34    | 17.0%      |
| mpi         | 4     | 0.029   | 0.45    | 11.3%      |
| mpi         | 6     | 0.026   | 0.50    | 8.3%      |

**–ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤:**
- –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º —Å MPI –ø—Ä–∏ –Ω–µ–±–æ–ª—å—à–∏—Ö —Ä–∞–∑–º–µ—Ä–∞—Ö –º–∞—Ç—Ä–∏—Ü—ã –Ω–µ –¥–∞–µ—Ç —É—Å–∫–æ—Ä–µ–Ω–∏—è –∏–∑-–∑–∞ –Ω–∞–∫–ª–∞–¥–Ω—ã—Ö —Ä–∞—Å—Ö–æ–¥–æ–≤ –Ω–∞ `MPI_Scatterv` –∏ –≤—ã–¥–µ–ª–µ–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω—ã—Ö –º–∞—Å—Å–∏–≤–æ–≤.
- –¢–æ–ª—å–∫–æ –æ–∫–æ–ª–æ 50% –≤—Ä–µ–º–µ–Ω–∏ —Ç—Ä–∞—Ç–∏—Ç—Å—è –Ω–∞ Scatterv, –µ—â–µ 15% ‚Äî –Ω–∞ –≤—ã–¥–µ–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏.
- –ï—Å–ª–∏ —É—á–∏—Ç—ã–≤–∞—Ç—å —á–∏—Å—Ç—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è (–ª–æ–∫–∞–ª—å–Ω–æ–µ —É–º–Ω–æ–∂–µ–Ω–∏–µ –º–∞—Ç—Ä–∏—Ü—ã –Ω–∞ –≤–µ–∫—Ç–æ—Ä), —É—Å–∫–æ—Ä–µ–Ω–∏–µ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –ª–∏–Ω–µ–π–Ω–æ —Å —á–∏—Å–ª–æ–º –ø—Ä–æ—Ü–µ—Å—Å–æ–≤, –Ω–æ –Ω–∞–∫–ª–∞–¥–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã —Å–∏–ª—å–Ω–æ —Å–Ω–∏–∂–∞—é—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å.

## 8. –ó–∞–∫–ª—é—á–µ–Ω–∏–µ
–†–∞–∑—Ä–∞–±–æ—Ç–∞–Ω—ã –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è –∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è (MPI) —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ —É–º–Ω–æ–∂–µ–Ω–∏—è –º–∞—Ç—Ä–∏—Ü—ã –Ω–∞ –≤–µ–∫—Ç–æ—Ä —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–π –ª–µ–Ω—Ç–æ—á–Ω–æ–π —Å—Ö–µ–º—ã.

–í MPI-–≤–µ—Ä—Å–∏–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —Å—Ç—Ä–∞—Ç–µ–≥–∏—è —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è —Å—Ç–æ–ª–±—Ü–æ–≤ –º–∞—Ç—Ä–∏—Ü—ã –º–µ–∂–¥—É –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∫–∞–∂–¥–æ–º—É –ø—Ä–æ—Ü–µ—Å—Å—É –≤—ã—á–∏—Å–ª—è—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–π –≤–∫–ª–∞–¥ –≤ —Ä–µ–∑—É–ª—å—Ç–∏—Ä—É—é—â–∏–π –≤–µ–∫—Ç–æ—Ä. –î–ª—è —Å–±–æ—Ä–∞ –∏—Ç–æ–≥–æ–≤–æ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞ –∫–æ–ª–ª–µ–∫—Ç–∏–≤–Ω–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è `MPI_Reduce` —Å —Å—É–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ–º (MPI_SUM).

–ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –ø–æ–∫–∞–∑–∞–ª, —á—Ç–æ –Ω–∞–∫–ª–∞–¥–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã –Ω–∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö (MPI_Scatterv) –∏ –≤—ã–¥–µ–ª–µ–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω—ã—Ö –±–ª–æ–∫–æ–≤ –ø–∞–º—è—Ç–∏ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –≤–ª–∏—è—é—Ç –Ω–∞ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å. –ù–µ—Å–º–æ—Ç—Ä—è –Ω–∞ —ç—Ç–æ, –ø—Ä–∏ —É–≤–µ–ª–∏—á–µ–Ω–∏–∏ —Ä–∞–∑–º–µ—Ä–∞ –∑–∞–¥–∞—á–∏ –∏–ª–∏ —á–∏—Å–ª–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ —á–∏—Å—Ç–æ–µ –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –ª–æ–∫–∞–ª—å–Ω—ã—Ö —É–º–Ω–æ–∂–µ–Ω–∏–π –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç—Å—è –ø–æ—á—Ç–∏ –ª–∏–Ω–µ–π–Ω–æ.

–í—ã–≤–æ–¥: –¥–ª—è –ø–æ–¥–æ–±–Ω—ã—Ö –∑–∞–¥–∞—á —Å –≤—ã—Å–æ–∫–æ–π –¥–æ–ª–µ–π –æ–ø–µ—Ä–∞—Ü–∏–π —Å –ø–∞–º—è—Ç—å—é –∫–ª—é—á–µ–≤—ã–º —Ñ–∞–∫—Ç–æ—Ä–æ–º —É—Å–∫–æ—Ä–µ–Ω–∏—è —è–≤–ª—è–µ—Ç—Å—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∏ —É–º–µ–Ω—å—à–µ–Ω–∏–µ –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–æ–Ω–Ω—ã—Ö –Ω–∞–∫–ª–∞–¥–Ω—ã—Ö —Ä–∞—Å—Ö–æ–¥–æ–≤.

## 9. –ò—Å—Ç–æ—á–Ω–∏–∫–∏
1. Microsoft MPI : –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è [–≠–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ã–π —Ä–µ—Å—É—Ä—Å] // Microsoft Learn. ‚Äì URL: https://learn.microsoft.com/ru-ru/message-passing-interface/microsoft-mpi (–¥–∞—Ç–∞ –æ–±—Ä–∞—â–µ–Ω–∏—è: 12.11.2025).
2. –°—ã—Å–æ–µ–≤ –ê. –í. –ö—É—Ä—Å –ª–µ–∫—Ü–∏–π –ø–æ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–º—É –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—é
3. –ù–µ—Å—Ç–µ—Ä–æ–≤ –ê.–Æ –∏ –û–±–æ–ª–µ–Ω—Å–∫–∏–π –ê.–ê –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–Ω—è—Ç–∏—è

## 9. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

```cpp
namespace {

std::vector<int> ComputeSendCountsAndDispls(int cols, int size, std::vector<int> &displs) {
  std::vector<int> sendcounts(size);
  const int base_cols = cols / size;
  const int rem_cols = cols % size;
  int offset = 0;
  for (int i = 0; i < size; ++i) {
    sendcounts[i] = base_cols + (i < rem_cols ? 1 : 0);
    displs[i] = offset;
    offset += sendcounts[i];
  }
  return sendcounts;
}

void TransposeMatrix(const std::vector<double> &matrix, std::vector<double> &transposed, int rows, int cols) {
  for (int i = 0; i < rows; ++i) {
    for (int j = 0; j < cols; ++j) {
      transposed[(static_cast<size_t>(j) * rows) + i] = matrix[(static_cast<size_t>(i) * cols) + j];
    }
  }
}

void LocalMatVecMul(const std::vector<double> &local_matrix, const std::vector<double> &local_b,
                    std::vector<double> &local_res, int rows, int local_cols) {
  for (int j = 0; j < local_cols; ++j) {
    const double b_val = local_b[j];
    for (int i = 0; i < rows; ++i) {
      local_res[i] += local_matrix[(static_cast<size_t>(j) * rows) + i] * b_val;
    }
  }
}

}  // namespace

bool KruglovaAVerticalRibbMatMPI::RunImpl() {
  int rank = 0;
  int size = 0;
  MPI_Comm_rank(MPI_COMM_WORLD, &rank);
  MPI_Comm_size(MPI_COMM_WORLD, &size);

  int rows = 0;
  int cols = 0;
  if (rank == 0) {
    rows = std::get<0>(GetInput());
    cols = std::get<1>(GetInput());
  }

  MPI_Bcast(&rows, 1, MPI_INT, 0, MPI_COMM_WORLD);
  MPI_Bcast(&cols, 1, MPI_INT, 0, MPI_COMM_WORLD);

  std::vector<int> displs(size);
  std::vector<int> sendcounts = ComputeSendCountsAndDispls(cols, size, displs);

  int local_cols = sendcounts[rank];
  std::vector<double> local_b(local_cols);

  const double *global_b_ptr = (rank == 0) ? std::get<3>(GetInput()).data() : nullptr;
  MPI_Scatterv(global_b_ptr, sendcounts.data(), displs.data(), MPI_DOUBLE, local_b.data(), local_cols, MPI_DOUBLE, 0,
               MPI_COMM_WORLD);

  std::vector<double> transposed_matrix;
  if (rank == 0) {
    const auto &matrix = std::get<2>(GetInput());
    transposed_matrix.resize(static_cast<size_t>(rows) * cols);
    TransposeMatrix(matrix, transposed_matrix, rows, cols);
  }

  std::vector<int> mat_sendcounts(size);
  std::vector<int> mat_displs(size);
  for (int i = 0; i < size; ++i) {
    mat_sendcounts[i] = sendcounts[i] * rows;
    mat_displs[i] = displs[i] * rows;
  }

  std::vector<double> local_matrix(static_cast<size_t>(local_cols) * rows);
  MPI_Scatterv(rank == 0 ? transposed_matrix.data() : nullptr, mat_sendcounts.data(), mat_displs.data(), MPI_DOUBLE,
               local_matrix.data(), local_cols * rows, MPI_DOUBLE, 0, MPI_COMM_WORLD);

  std::vector<double> local_res(rows, 0.0);
  LocalMatVecMul(local_matrix, local_b, local_res, rows, local_cols);

  double *global_res_ptr = (rank == 0) ? GetOutput().data() : nullptr;
  MPI_Reduce(local_res.data(), global_res_ptr, rows, MPI_DOUBLE, MPI_SUM, 0, MPI_COMM_WORLD);

  return true;
}
```