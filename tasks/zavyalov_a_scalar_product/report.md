# Скалярное произведение векторов

- Student: Завьялов Алексей Алексеевич, group 3823Б1ФИ3
- Technology: SEQ | MPI
- Variant: 9

## 1. Introduction

Скалярное произведение имеет широкую область применения в современном мире, в связи с чем возникает необходимость оптимизировать процесс его нахождения.

Ожидается небольшое ускорение mpi версии программы относительно последовательной версии.

## 2. Problem Statement
Скалярное произведение двух векторов одной размерности - это число, равное сумме произведений соответствующих координат этих векторов.
Требуется найти скалярное произведение двух заданных векторов.

```math
(a, b) = \sum_{i=0}^{n-1} a_i b_i.
```

### Входные данные: 
Два математических вектора произвольной размерности, состоящих из действительных чисел.

### Выходные данные:
Одно действительное число - скалярное произведение заданных векторов.

## 3. Baseline Algorithm (Sequential)
Инициализируем результат значением 0. Затем последовательно проходим по векторам, добавляя к результату произведение соответствующих координат.

## 4. Parallelization Scheme
Делим размер вектора нацело на `n`, где `n` - число процессов, получаем размер блока.

Корневой процесс рассылает остальным соответствующие части обоих векторов. В случае, когда размер вектора не кратен n, то есть когда при делении остаётся остаток `remainder`, не равный 0, первым `remainder` процессам отсылается на 1 элемент каждого вектора больше. Этот этап реализуется с помощью функции `MPI_Scatterv()`

Далее каждый процесс вычисляет свою часть слагаемых, составляющих скалярное произведение.

В конце работы результаты всех процессов складываются и записываются в ответ с помощью функции `MPI_Allreduce()`.

## 5. Experimental Setup
- Hardware/OS: AMD Ryzen 5 7520U, 4 ядра, 16 GB RAM, Windows 10 x64
- Toolchain: compiler, version, build type (Release/RelWithDebInfo)
    - Cmake 3.28.3
    - Компилятор: g++ (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0
    - Использовался Docker-контейнер.
    - Режим сборки: Release.
- Data: Для замера производительности использовались векторы размером 100.000.000, генерируемые следующим образом:
    - Первый вектор состоит из натуральных чисел от 0 до 99.999.999 включительно.
    - Второй вектор состоит из чётных натуральных чисел от 0 до 199.999.998.

## 6. Results and Discussion

### 6.1 Correctness
Корректность работы проверена с помощью тестов Google Test на парах векторов размером от 1 до 10 включительно. 

### 6.2 Performance
| Mode        | Count | Time, s | Speedup | Efficiency |
|-------------|-------|---------|---------|------------|
| seq         | 1     | 0.760   | 1.00    | N/A        |
| mpi         | 2     | 0.674   | 1.12    | 56.0%      |
| mpi         | 4     | 0.638   | 1.19    | 29.75%     |

## 7. Conclusions
Накладные расходы на работу с процессами сильно влияют на скорость работы программы, из-за чего эффективность mpi версии значительно меньше 100%.

## 8. References
1. Курс лекций ННГУ "Параллельное программирование для кластерных систем"